sudo: required
services:
  - docker

script:
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-base -f Dockerfile.ana.base .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-tensorflow -f Dockerfile.ana.tensorflow .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-keras -f Dockerfile.ana.keras .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-pytorch -f Dockerfile.ana.pytorch .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-pytorch-mini -f Dockerfile.mini.base .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-tensorflow-mini -f Dockerfile.mini.tensorflow .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-keras-mini -f Dockerfile.mini.keras .
  - travis_wait 30 docker image build -t $DOCKER_USERNAME/ml-pytorch-mini -f Dockerfile.mini.pytorch .

after_success:
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker push $DOCKER_USERNAME/ml-base
  - docker push $DOCKER_USERNAME/ml-tensorflow
  - docker push $DOCKER_USERNAME/ml-keras
  - docker push $DOCKER_USERNAME/ml-pytorch
  - docker push $DOCKER_USERNAME/ml-base-mini
  - docker push $DOCKER_USERNAME/ml-tensorflow-mini
  - docker push $DOCKER_USERNAME/ml-keras-mini
  - docker push $DOCKER_USERNAME/ml-pytorch-mini
